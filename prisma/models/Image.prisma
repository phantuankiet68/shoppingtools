model ImageFolder {
  id        String @id @default(cuid())
  userId    String
  user      User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  name      String
  parentId  String?
  parent    ImageFolder? @relation("ImageFolderTree", fields: [parentId], references: [id], onDelete: SetNull)
  children  ImageFolder[] @relation("ImageFolderTree")

  images    ImageAsset[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId, parentId])
  @@unique([userId, parentId, name])

  @@unique([id, userId])
}

model ImageAsset {
  id       String @id @default(cuid())

  userId   String
  user     User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  folderId String?
  folder   ImageFolder? @relation(fields: [folderId, userId], references: [id, userId], onDelete: Restrict)

  originalName String
  fileName     String
  mimeType     String
  sizeBytes    Int

  width   Int?
  height  Int?

  tag     ImageTag?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId, createdAt])
  @@index([userId, tag])
  @@unique([fileName])
}


enum ImageTag {
  NEW
  HDR
  AI
  FAVORITE
  COVER
  BANNER
  AVATAR
  PRODUCT
}
