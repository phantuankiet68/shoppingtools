enum IntegrationCategory {
  payments
  email
  analytics
  storage
  ai
  crm
}

enum IntegrationStatus {
  disconnected
  connected
  error
}

enum LogLevel {
  info
  warn
  error
}

model Integration {
  id          String              @id @default(cuid())
  key         String              @unique
  name        String
  category    IntegrationCategory
  description String?

  enabled     Boolean             @default(false)
  status      IntegrationStatus   @default(disconnected)

  config      Json                @default("{}")

  apiKeyEnc      String?
  apiSecretEnc   String?
  webhookUrlEnc  String?

  lastSyncAt   DateTime?
  createdAt    DateTime            @default(now())
  updatedAt    DateTime            @updatedAt

  logs         IntegrationLog[]
}

model IntegrationLog {
  id            String       @id @default(cuid())
  integrationId String
  level         LogLevel     @default(info)
  message       String
  meta          Json         @default("{}")
  createdAt     DateTime     @default(now())

  integration   Integration  @relation(fields: [integrationId], references: [id], onDelete: Cascade)

  @@index([integrationId, createdAt])
}
